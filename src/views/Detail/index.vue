<!-- ÊôÆÈÄöÊñáÁ´†ËØ¶ÊÉÖÈ°µ -->
<script setup>
import { useRoute } from "vue-router";
import ArticleComment from "./components/ArticleComment.vue";
import ArticlePreview from "./components/ArticlePreview.vue";
import { onMounted, ref } from "vue";
import { getShopDetail } from "@/apis/shop";
import { getShopInteraction } from "@/apis/shopInteraction";

// Ê®°ÊãüÊñáÁ´†Êï∞ÊçÆ
const article = ref({
  content:
    "# Linux\n" +
    "***vue :*** [vue3](https://cn.vuejs.org/)\n" +
    "***CSDN :*** [CSDNÂÆòÁΩë](https://www.csdn.net/)\n" +
    "***LeetCode :*** [ÂäõÊâ£Âà∑È¢ò](https://leetcode.cn/problems/)\n" +
    "[linux](http://linux.vbird.org/linux_basic/)\n" +
    "## ÂâçÁ´Ø\n" +
    "***vue :*** [vue3](https://cn.vuejs.org/)\n" +
    "***CSDN :*** [CSDNÂÆòÁΩë](https://www.csdn.net/)\n" +
    "***LeetCode :*** [ÂäõÊâ£Âà∑È¢ò](https://leetcode.cn/problems/)\n" +
    "## ÂêéÁ´Ø\n" +
    "***Java :*** [JavaÊïôÁ®ã](https://www.runoob.com/java/java-tutorial.html)\n" +
    "***Spring :*** [SpringÊïôÁ®ã](https://spring.io/guides)\n" +
    "***SpringBoot :*** [SpringBootÊïôÁ®ã](https://spring.io/projects/spring-boot)\n" +
    "***SpringCloud :*** [SpringCloudÊïôÁ®ã](https://spring.io/projects/spring-cloud)\n",
  // // ÂºÄÂêØÊñáÁ´†ËØÑËÆ∫
  // commentabled: true,
});
// Êé•Êî∂ÂèÇÊï∞
const route = useRoute();
const name = ref(route.params.name);
const contentment = ref([]);
// ÂèëÈÄÅËØ∑Ê±ÇÊé•Êî∂Êï∞ÊçÆ
onMounted: {
  //Êé•Êî∂ÂèÇÊï∞
  getShopDetail({ sushi_name: name.value }).then((res) => {
    console.log("Ëé∑ÂèñÊñáÁ´†‰ø°ÊÅØ", res.data);
    article.value = res.data;
  });
  // Êé•Êî∂ÊñáÁ´†ËØÑËÆ∫
  // console.log("Ëøô‰∫õÂì™ÈáåÔºü", route.query.aid);
  //   getPublicContentment(route.query.aid).then((res) => {
  //     // console.log("ÊñáÁ´†ËØÑËÆ∫", res);
  //     contentment.value = res.data;

  //     // ËØÑËÆ∫Â§¥ÂÉèÂ§ÑÁêÜ
  //     for (let i = 0; i < contentment.value.length; i++) {
  //       const img = `data:image/jpg;base64,${res.data[i].uavator}`;
  //       contentment.value[i].uavator = img;

  //       // ËØÑËÆ∫Â≠êÂ§¥ÂÉèÂ§ÑÁêÜ
  //       for (let j = 0; j < contentment.value[i].subReply.length; j++) {
  //         const img2 = `data:image/jpg;base64,${res.data[i].subReply[j].uavator}`;
  //         contentment.value[i].subReply[j].uavator = img2;
  //       }
  //     }
  //   });

  // Ê®°ÊãüËØÑËÆ∫Êï∞ÊçÆ
  contentment.value = [
    //     {
    //     uid: 1,
    //     nickname: 'Êàë‰ºöÁî®vue3',
    //     createTime: '2023-6-3 19:22',
    //     content: 'ÊàëÁöÑ uid ÊòØ \'1\' üòé‰∏éÊ®°Êãü ( ËøôÊù°ËØÑËÆ∫ÊàëÂèëÁöÑ ) ÁöÑ‰∏ÄÊ†∑,Âõ†Ê≠§Êàë‰ºöÊúâ -Âà†Èô§- ÊåâÈíÆüêî',
    //     uavator: 'https://img0.baidu.com/it/u=1091210682,206783907&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1684602000&t=1813754cb45a25a646263c4b3a711514',
    //     // Â≠êËØÑËÆ∫
    //     subReply: [{
    //         uid: 2,
    //         nickname: 'ÊàëÂú®Â≠¶pinia',
    //         createTime: '2023-6-4 12:32',
    //         content: 'ÊàëÁöÑ uid ÊòØ \'2\' ÊàëÊù•Áé©‰∫Üü•≥',
    //         uavator: 'src/assets/imgs/uid2.png'
    //     },
    //     {
    //         uid: 1,
    //         nickname: 'Êàë‰ºöÁî®vue3',
    //         createTime: '2023-6-4 12:39',
    //         content: 'ÊàëÁöÑ uid ÊòØ \'1\' Ê¨¢ËøéÊ¨¢Ëøé Ê≥∞Â∫ìËæ£ü•≥',
    //         uavator: 'https://img0.baidu.com/it/u=1091210682,206783907&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1684602000&t=1813754cb45a25a646263c4b3a711514'
    //     }]
    // }, {
    //     uid: 2,
    //     nickname: 'ÊàëÂú®Â≠¶pinia',
    //     createTime: '2023-6-3 22:32',
    //     content: 'ÊàëÁöÑ uid ÊòØ \'2\' ÊàëÊ≤°Êúâ -Âà†Èô§- ÊåâÈíÆüêî Âõ†‰∏∫‰∏äÈù¢ÁöÑËØÑËÆ∫‰∏çÊòØÊàëÂèëÁöÑ',
    //     uavator: 'src/assets/imgs/uid2.png',
    // },
    // {
    //     uid: 2,
    //     nickname: 'ÊàëÂú®Â≠¶pinia',
    //     createTime: '2023-6-3 22:32',
    //     content: 'ÂøòËÆ∞ÂëäËØâ‰Ω†‰ª¨‰∫ÜÔºÅÂõ†‰∏∫ÊòØÊ®°ÊãüÊï∞ÊçÆÊâÄ‰ª•Ëøô‰∫õÊåâÈíÆ‰πüÂ∞±Êàê‰∏∫ÊëÜËÆæ‰∫Üüòò',
    //     uavator: 'src/assets/imgs/uid2.png',
    // }
  ];

  let username = localStorage.getItem("user_name");

  // Ëé∑ÂèñÁÇπËµûÂíåÊî∂Ëóè„ÄÅËØÑËÆ∫Áä∂ÊÄÅ
  getShopInteraction(name.value, username).then((res) => {
    // Ëé∑ÂèñÁî®Êà∑Âêç

    console.log("Ëé∑ÂèñÁÇπËµûÂíåÊî∂Ëóè„ÄÅËØÑËÆ∫Áä∂ÊÄÅ", res);
    // isLiked.value = res.data.isLiked;
    // isFavorited.value = res.data.isFavorited;
  });
}

// ËÆæÁΩÆÁÇπËµûÂíåÊî∂ËóèÁöÑÁä∂ÊÄÅ
const isLiked = ref(false);
const isFavorited = ref(false);

// ÁÇπÂáªÂ§ÑÁêÜÂáΩÊï∞
const toggleLike = () => {
  isLiked.value = !isLiked.value;
};

const toggleFavorite = () => {
  isFavorited.value = !isFavorited.value;
};
</script>

<template>
  <div class="detail-container">
    <el-card class="card">
      <!-- Ê†áÁ≠æÊ†è -->
      <!-- <div style="margin-bottom: 10px">
        <el-text class="title">{{ article.title }}</el-text>
      </div> -->
      <!-- <div class="tagLine">
        <el-text class="text">ÊñáÁ´†Ê†áÁ≠æ:</el-text>
        <el-tag class="tag" v-for="tag in article.tags">{{ tag.name }}</el-tag>
      </div> -->
      <!-- <ArticlePreview :content="article.content" /> -->
      <ArticlePreview :content="article.content" />
    </el-card>
    <!-- ËØÑËÆ∫Âå∫ ‰º†ÂÖ•ËØÑËÆ∫ÂèÇÊï∞ -->
    <ArticleComment />

    <!-- ÁÇπËµûÂíåÊî∂ËóèÊåâÈíÆÂå∫Âüü -->
    <div class="raise-container">
      <!-- ÁÇπËµûÊåâÈíÆ -->
      <button @click="toggleLike" class="icon-btn">
        <i :class="isLiked ? 'fas fa-thumbs-up' : 'far fa-thumbs-up'"></i>
      </button>

      <!-- Êî∂ËóèÊåâÈíÆ -->
      <button @click="toggleFavorite" class="icon-btn">
        <i :class="isFavorited ? 'fas fa-star' : 'far fa-star'"></i>
      </button>
    </div>
  </div>
</template>

<style scoped>
.detail-container {
  padding: 20px 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: #f7f7f7;
}

.card {
  width: 950px;
  border-radius: 9px;
  background-color: #fff;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.title {
  font-size: 24px;
  font-weight: bolder;
  color: #000;
  padding-left: 16px;
}

.text {
  font-size: 14px;
  color: #000;
  margin-right: 10px;
}

.iconfont {
  font-size: 25px;
}

.raise-container {
  position: fixed;
  margin-left: 1010px;
  margin-top: 180px;
  background: #eef1f4;
  width: 40px;
  height: 140px;
  padding: 12px 6px;
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.raise-container button {
  background: none;
  border: none;
  color: #4e9df1;
  font-size: 28px;
  margin-bottom: 30px;
  transition: color 0.3s ease, transform 0.3s ease;
}

.raise-container button:hover {
  color: #007acc;
  transform: scale(1.1);
}

.raise-container button.active {
  color: #007acc;
}

.raise-container button.active:hover {
  color: #005b99;
}

.tagLine {
  margin-left: 16px;
  margin-bottom: 10px;
}

.tag {
  margin-right: 5px;
  margin-bottom: 5px;
}

/* .raise-container {
  position: fixed;
  margin-left: 1010px;
  margin-top: 180px;
  background: green;
  width: 29px;
  height: 108px;
  padding: 12px 6px;
  border-radius: 6px;
} */

/* ÊâãÊú∫Á´Ø */
@media (max-width: 768px) {
  .card {
    width: 100%;
  }
}

/* ipadÁ´Ø */
@media (max-width: 1024px) {
  .card {
    width: 100%;
  }
}
</style>